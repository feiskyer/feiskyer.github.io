<!DOCTYPE html>
<html lang="zh-cn">
    
  <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.62.2" />

    

<title>Feisky</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Feisky"/>
<meta name="twitter:description" content="Notes about anything"/>

<meta property="og:title" content="Feisky" />
<meta property="og:description" content="Notes about anything" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://feisky.xyz/" />
<meta property="og:updated_time" content="2018-10-14T22:08:45+08:00" />


    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">








<link rel="stylesheet" href="/scss/hyde-hyde.92c66d107d7b219f0792cfd67223179af884b03f386ac46894f9f735932bbca3.css" integrity="sha256-ksZtEH17IZ8Hks/WciMXmviEsD84asRolPn3NZMrvKM=">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">




<link rel="stylesheet" href="/scss/tocbot.126e7d75240acc946d34d6ccb2982ed4c394a5fe34e73e1a2119ca951bcf119d.css" integrity="sha256-Em59dSQKzJRtNNbMspgu1MOUpf405z4aIRnKlRvPEZ0=">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    <link rel="alternate" type="application/rss+xml" href="https://feisky.xyz/index.xml" title="Feisky" />

    

</head>


    <body class="theme-base-0d ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://feisky.xyz/">Feisky</a>
      </span>
      
      
      <p class="site__description">
         Notes about anything 
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Feisky</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="https://kubernetes.feisky.xyz">
						<span>Kubernetes指南</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="https://time.geekbang.org/column/intro/100020901">
						<span>Linux性能优化实战</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="https://sdn.feisky.xyz">
						<span>SDN网络</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/machine-learning/">
						<span>机器学习</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/about/">
						<span>关于我</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/feisky" rel="me"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	
	<a href="https://github.com/feiskyer" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
</section>

      </div>
    </div>
    
<div class="copyright">
  &copy; 2020 feiskyer
  
    <a href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0</a>
  
</div>


<div class="builtwith">
Built with <a href="https://gohugo.io">Hugo</a> ❤️ <a href="https://github.com/htr3n/hyde-hyde">hyde-hyde</a>.
</div>


  </div>
</div>

        <div class="content container">
            
  <div class="post-list">
    
    
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/2014-11-19-docker%E5%BA%95%E5%B1%82%E6%8A%80%E6%9C%AF%E6%A6%82%E8%A7%88-feisky/" >docker底层技术概览 - feisky</a>
        </span>
        <span class="item__date">
          Nov 19, 2014
        </span>
        <span >
        
        【摘要】docker解决了云计算环境难于分发并且管理复杂，而用KVM、Xen等虚拟化又浪费系统资源的问题。Docker最初是基于lxc构建了
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/2014-11-19-docker%E5%BA%95%E5%B1%82%E6%8A%80%E6%9C%AF%E6%A6%82%E8%A7%88-feisky/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/2014-11-18-openstack%E9%83%A8%E7%BD%B2%E5%B7%A5%E5%85%B7%E6%80%BB%E7%BB%93-feisky/" >OpenStack部署工具总结 - feisky</a>
        </span>
        <span class="item__date">
          Nov 18, 2014
        </span>
        <span >
        
        【摘要】目前感觉比较简单直观的部署工具有RDO、devstack、Fuel等：1. RDOhttps://openstack.redhat.c
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/2014-11-18-openstack%E9%83%A8%E7%BD%B2%E5%B7%A5%E5%85%B7%E6%80%BB%E7%BB%93-feisky/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/2014-11-18-%E4%BD%BF%E7%94%A8-device-mapper%E6%9D%A5%E6%94%B9%E5%8F%98docker%E5%AE%B9%E5%99%A8%E7%9A%84%E5%A4%A7%E5%B0%8F-feisky/" >使用 Device Mapper来改变Docker容器的大小 - feisky</a>
        </span>
        <span class="item__date">
          Nov 18, 2014
        </span>
        <span >
        
        【摘要】作者：Jérôme Petazzoni（ Docker 布道师）译者：Mark Shao（ EMC 中国高级工程师）如果在 CentOS 、 REHL 、 Fedor 或者其他默认没有 AUFS 支持的 Linux
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/2014-11-18-%E4%BD%BF%E7%94%A8-device-mapper%E6%9D%A5%E6%94%B9%E5%8F%98docker%E5%AE%B9%E5%99%A8%E7%9A%84%E5%A4%A7%E5%B0%8F-feisky/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/2014-11-18-%E4%BB%8Eveth%E7%9C%8B%E8%99%9A%E6%8B%9F%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E7%9A%84qdisc-feisky/" >从veth看虚拟网络设备的qdisc - feisky</a>
        </span>
        <span class="item__date">
          Nov 18, 2014
        </span>
        <span >
        
        【摘要】背景前段时间在测试docker的网络性能的时候，发现了一个veth的性能问题，后来给docker官方提交了一个PR，参考set tx_queuelen to 0
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/2014-11-18-%E4%BB%8Eveth%E7%9C%8B%E8%99%9A%E6%8B%9F%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E7%9A%84qdisc-feisky/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/2014-11-18-docker%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93-feisky/" >docker网络配置方法总结 - feisky</a>
        </span>
        <span class="item__date">
          Nov 18, 2014
        </span>
        <span >
        
        【摘要】docker启动时，会在宿主主机上创建一个名为docker0的虚拟网络接口，默认选择172.17.42.1/16，一个16位的子网掩
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/2014-11-18-docker%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93-feisky/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/2014-11-18-kubernetes%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84%E7%AE%80%E4%BB%8B-feisky/" >Kubernetes系统架构简介 - feisky</a>
        </span>
        <span class="item__date">
          Nov 18, 2014
        </span>
        <span >
        
        【摘要】1. 前言Together we will ensure that Kubernetes is a strong and open container management framework for any application and in any environment, whether i&hellip; 阅读全文
        
        </span>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/2014-11-16-%E9%9B%86%E7%BE%A4%E5%B7%A5%E5%85%B7ansible%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95-feisky/" >集群工具ansible使用方法 - feisky</a>
        </span>
        <span class="item__date">
          Nov 16, 2014
        </span>
        <span >
        
        【摘要】ansible简介ansible是与puppet、saltstack类似的集群管理工具，其优点是仅需要ssh和Python即可使用，
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/2014-11-16-%E9%9B%86%E7%BE%A4%E5%B7%A5%E5%85%B7ansible%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95-feisky/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/2017-02-13-software-engineering-at-google/" ></a>
        </span>
        <span class="item__date">
          Jan 01, 0001
        </span>
        <span >
        
        layout: post title: Software Engineering at Google date: 2017-02-13 19:36:09 tags: [Google] Google的Fergus Henderson在Software Engineering at Google中介绍了Google的软件工程实践。
软件开发 源码仓库
 单一源代码仓库，除了核心配置和安全相关代码，任何工程师都可以访问任何代码，并可以根据需要修改 所有开发都基于master分支，发布的时候才创建发布分枝 代码的每个子树都有owner，任何修改都需要owner批准  Blaze分布式构建系统
 构建和测试存储库中的任何软件通常非常简单和快捷 开发人员只需要编写BUILD文件，并且每个构建系统仅依赖BUILD文件所声明的文件 构建系统的优化：可靠，自动跟踪依赖关系，增量构建，缓存构建结果以便复用 自动代码检查和测试  代码审查
 完善的代码审查工具，如可视化的Web界面、电子邮件集成、自动展示测试或静态分析的结果 每个变更都必须由至少另外一人审查，并将审查结果自动复制到项目维护者的邮件列表 鼓励小的变更，大的变更可以拆分为一系列较小的变更  测试
 鼓励和广泛使用单元测试，Mocking非常普遍 广泛使用集成测试和回归测试 自动测量测试覆盖率 部署之前进行负载测试，显示关键的metrics，比如延迟、错误率以及它们随请求速率的变化情况  Bug跟踪
 Google使用名为Buganizer的Bug跟踪系统 使用标签分类bug 每个bug都有一个默认的assignee和抄送邮件列表  编程语言
 鼓励使用C++、Java、Python或Go之一，最小化不同编程语言的数量 每种语言都有Google风格指南，还有一个公司范围内的可读性培训 不同语言之前使用基于Protocol Buffers的RPC通信 为所有语言提供通用的开发工具，比如代码签出、编辑、构建、测试、审查、bug报告等  调试和分析
 在通用框架中提供调试和代码跟踪工具 提供用于调试的网络接口检查RPC调用的时间、错误率和频率限制以及资源消耗、性能分析数据等  发布
 频繁发布（比如每周或每两周），自动化发布任务，提高工程师积极性，允许更多迭代以加快整体速度 发布分支，将master的修改cherry-pick到发布分支 发布到staging服务器，测试部分生产流量的副本 发布到canary服务器，测试真实生产流量的一个子集 最后逐步发布到所有服务器  Launch approval
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/2017-02-13-software-engineering-at-google/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/2017-03-03-aws-s3%E6%95%85%E9%9A%9C%E5%9B%9E%E9%A1%BE%E5%92%8C%E6%80%BB%E7%BB%93/" ></a>
        </span>
        <span class="item__date">
          Jan 01, 0001
        </span>
        <span >
        
        layout: post title: AWS S3故障回顾和总结 date: 2017-03-03 22:27:50 tags: [aws] S3故障回顾 2月28日，AWS工程师在排查Northern Virginia (US-EAST-1) Region的一个S3计费问题时，因敲错了一条playbook的参数而误删了大量的s3控制服务引发了4小时的故障。这个误操作影响了两个S3的核心系统：
 Index系统，管理S3对象的元数据和位置，主要处理GET、LIST、PUT、DELETE请求 Placement系统，管理新存储的分配和，主要处理PUT请求  由于S3的故障，一大批依赖于S3的AWS服务也发生故障（如EC2、EBS和Lambda等），进而也影响了近半的北美互联网服务。不过，这次故障只是影响了用户的访问，并没有丢失数据（可靠性还是保障的，S3有7个9的可靠性和4个9的可用性）。
虽然aws s3具有优秀的故障设计，在故障发生时一般会自动恢复。但是，由于s3极好的稳定性，Index和Placement系统已经多年未重启过了，这次重启重建index的时间超过预期，并且placement依赖于index系统，导致系统恢复花费了较长的时间。
改进措施  完善工具，保证即便有人操作错误也不会引发故障（对事不对人） 让删除操作缓慢些（以便有时间反悔） 加上一个最小资源数限制的SafeGuard 拆分现有的服务为更小单元（factoring services into cells），减小服务故障影响面，缩短服务的恢复时间  教训  高可用很难，不仅包括系统架构的高可用，更包括运维的高可用 跨Region和跨Availability Zone的重要性（比如Amazon和Netflix的服务并未受影响，因为它们在设计之初就处理了Region失效的问题），可以考虑的方案包括  跨Region的数据备份和恢复 跨Region的主从服务，包括Warm standby和Hot standby 跨Region的主主服务   故障恢复的重要性，充分保证Recovery Time Objective (RTO) and Recovery Point Objective (RPO) 自动化，人总是会犯错的，应该用技术而不是管理来解决问题（敏感操作放慢进程，以便有时间反悔） 故障和恢复演练，比如Google SRE指出他们有一个定期的服务停机计划，以验证系统是否真的符合预期  一个高可用系统的参考架构，图片来自The Learning AWS Blog
参考链接  Summary of the Amazon S3 Service Disruption in the Northern Virginia (US-EAST-1) Region How should we think about the aws outage Hacker News讨论 AWS 的 S3 故障回顾和思考  
        
        </span>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/2017-03-03-gitlab%E6%95%85%E9%9A%9C%E5%9B%9E%E9%A1%BE%E5%92%8C%E6%80%BB%E7%BB%93/" ></a>
        </span>
        <span class="item__date">
          Jan 01, 0001
        </span>
        <span >
        
        layout: post title: Gitlab故障回顾和总结 date: 2017-03-03 22:27:37 tags: [] Gitlab故障回顾 1月31日，Giblab在修复一个PostgreSQL数据同步问题（DB Replication lagged too far behind）时，误将生产环境的数据删除（本来是计划删除db1上的数据，结果发现在错误的db2上操作了）。进而寻求从备份数据恢复，结果发现没有实时备份：
 LVM Snapshot每24小时备份一次，最新数据是6小时前的 常规备份由于pg_dump客户端版本问题失效 Azure Disk snapshot未启用 数据库同步会导致webhook删除，所以webhook只能从备份中恢复 S3 备份未生效，bucket为空 糟糕的备份流程，并且没有明确的文档  最后，Gitlab只能从LVM snapshot上恢复6小时前的数据。由于备份机器性能极差，并且数据拷贝极慢，整个恢复过程也比较慢（18个小时）。
改进措施 故障发生后，Gitlab列出了一系列的改进措施，包括
 Update PS1 across all hosts to more clearly differentiate between hosts and environments (#1094) Prometheus monitoring for backups (#1095) Set PostgreSQL's max_connections to a sane value (#1096) Investigate Point in time recovery &amp; continuous archiving for PostgreSQL (#1097) Hourly LVM snapshots of the production databases (#1098) Azure disk snapshots of production databases (#1099) Move staging to the ARM environment (#1100) Recover production replica(s) (#1101) Automated testing of recovering PostgreSQL database backups (#1102) Improve PostgreSQL replication documentation/runbooks (#1103) Investigate pgbarman for creating PostgreSQL backups (#1105) Investigate using WAL-E as a means of Database Backup and Realtime Replication (#494) Build Streaming Database Restore Assign an owner for data durability Bundle pgpool-II 3.
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/2017-03-03-gitlab%E6%95%85%E9%9A%9C%E5%9B%9E%E9%A1%BE%E5%92%8C%E6%80%BB%E7%BB%93/">➦</a>
        
        </div>
        
     
  </div>
  

<ul class="pagination">
    
    <li class="page-item">
        <a href="/" class="page-link" aria-label="First"><span aria-hidden="true">&laquo;&laquo;</span></a>
    </li>
    
    <li class="page-item">
    <a href="/page/4/" class="page-link" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
    </li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/">1</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/page/2/">2</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/page/3/">3</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/page/4/">4</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item active"><a class="page-link" href="/page/5/">5</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/page/6/">6</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item disabled"><span aria-hidden="true">&nbsp;&hellip;&nbsp;</span></li>
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/page/11/">11</a></li>
    
    
    <li class="page-item">
    <a href="/page/6/" class="page-link" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
    </li>
    
    <li class="page-item">
        <a href="/page/11/" class="page-link" aria-label="Last"><span aria-hidden="true">&raquo;&raquo;</span></a>
    </li>
    
</ul>


        </div>
        
  
    
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-69699206-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  
  <script defer src="https://use.fontawesome.com/releases/v5.5.0/js/all.js" integrity="sha384-GqVMZRt5Gn7tB9D9q7ONtcp4gtHIUEW/yG7h98J7IpE3kpi+srfFyyB/04OV6pG0" crossorigin="anonymous"></script>


    </body>
</html>
